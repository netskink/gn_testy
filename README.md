# gn_testy


Experiments with gn (generate ninja)

## Notes

### gn and ninja files

gn will generate the initial ninja files.

Assuming the current directory has the following files:

* .gn
* BUILD.gn

This command sequence:

```
$ gn gen -C out
```

Will make an out dir.  In this dir will be the following files:

* args.gn
* build.ninja
* build.ninja.d
* build.ninja.stamp
* toolchain.ninja
* obj/ dir

For example three (mine3) obj/ dir will contain the following files:

* main.ninja
	- the exe 
* mymath.ninja
	- the static library (*.a)
* mystring.ninja
	- the dynamic/shared libray (*.so)

### gn and regenerating ninja files

Once you have run the `gn gen` command you do not need
to rerun `gn` explicitly even if you have modified the `BUILD.gn`
file.

The ninja files generated by ninja will automatically rerun ninja.  Here
is an example:

Generate the ninja files.

```
$ gn gen -C out
Done. Made 3 targets from 4 files in 7ms
```

Build the code using ninja

```
$ ninja -v -C out
ninja: Entering directory `out'
[1/6] g++ -MMD -MF obj/src/main.main.o.d     -c ../src/main.cc -o obj/src/main.main.o
[2/6] g++ -MMD -MF obj/src/libmymath.MyMath.o.d     -c ../src/MyMath.cc -o obj/src/libmymath.MyMath.o
[3/6] g++ -MMD -MF obj/src/libmystring.MyString.o.d -DMYSTRING_IMPLEMENTATION    -c ../src/MyString.cc -o obj/src/libmystring.MyString.o
[4/6] ar rcs obj/libmymath.a obj/src/libmymath.MyMath.o
[5/6] g++ -shared  -o ./libmystring.so -install_name @executable_path/./libmystring.so @libmystring.so.rsp
[6/6] g++  -o main @main.rsp  
```

Touch the original `BUILD.gn` file, rerun `ninja` and see how it reruns `gn.`

```
$ touch BUILD.gn 
$ ninja -v -C out
ninja: Entering directory `out'
[0/1] ../../../gn/out/gn --root=./.. -q --C --regeneration gen .
ninja: no work to do.
$
```